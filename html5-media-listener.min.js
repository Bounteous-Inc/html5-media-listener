!function(a,b){"use strict";function c(a){if(!(this instanceof c))return new c(a);if(!a.targets)throw new TypeError("Missing required configuration opts.targets");var b=this;b._players=j(a.targets),b._players.length&&(b._players.forEach(function(a){a.__html5PlayerId__||(a.__html5PlayerId__=n++);var c=a.__html5PlayerId__;(m[c]=m[c]||[]).push(b)}),b._handlers={},b._bindings=[])}function d(a){a.events.forEach(function(a){o[a]||(f(a,g),o[a]=!0)}),["percentages","seconds"].filter(function(b){return a[b].each.length+a[b].every.length}).length&&!o.timeupdate&&(f("timeupdate",h),o.timeupdate=!0)}function e(a){if(a.isTrusted){var b=a.target,c=b.__html5PlayerId__,d=m[c];d&&!d.length&&d.forEach(function(a){delete a._handlers[c],a._bindings.forEach(function(c){a._calculateMarks(b,c.config,c.handler)})})}}function f(b,c){a.addEventListener(b,function(a){var b=a.target,d=b.tagName;!a.isTrusted||"AUDIO"!==d&&"VIDEO"!==d||c(a)},!0)}function g(a){var b=a.target,c=m[b.__html5PlayerId__];c&&c.forEach(function(b){b.handleEvent.call(b,a)})}function h(a){var b=a.target,c=m[b.__html5PlayerId__];c&&c.forEach(function(b){b.handleTiming(a)})}function i(){var b;for(b in o)a.removeEventListener(b,g,!0);a.removeEventListener("timingupdate",h,!0),a.removeEventListener("durationchange",e,!0),o={}}function j(b){return Array.isArray(b)||(b=[b]),[].slice.call(a.querySelectorAll(b.join()))}function k(){b.Html5MediaTracker=function(){return{on:l,destroy:l}}}function l(){}if(b.navigator.userAgent.match(/MSIE [678]/gi))return k();var m={},n=1,o={};c.prototype.on=function(a,b){if("function"!=typeof b)throw new TypeError("Handler is not a function");var c={events:a.events||[],percentages:{},seconds:{}};["percentages","seconds"].forEach(function(b){["each","every"].forEach(function(d){c[b][d]=(a[b]||{})[d]||[]})}),d(c);var e=this;e._players.forEach(function(a){e._registerHandlers(a,c,b)}),e._bindings.push({config:c,handler:b})},c.prototype.destroy=function(){this.destroy=!0;var a,b,c=!1;for(a in m)for(b=m[a].length-1;b>=0;b--)m[a][b].destroy?m[a].splice(b,1):c=!0;c||i(),delete this._handlers,delete this._bindings},c.prototype.handleEvent=function(a){var b=a.type,c=a.target,d=c.__html5PlayerId__;if(this._handlers[d]&&this._handlers[d][b]&&("pause"!==b||!c.ended)){var e,f=this._handlers[d][b];for(e=0;e<f.length;e++)setTimeout(f[e],0)}},c.prototype.handleTiming=function(a){var b,c,d=a.target,e=Math.ceil(d.currentTime),f=d.__html5PlayerId__,g=this._handlers[f],h=[];for(b in g)Number(b)<=e&&(h=h.concat(g[b]),delete g[b]);for(c=0;c<h.length;c++)setTimeout(h[c],0)},c._translateSeconds=function(a){var b=Math.floor(a/3600),c=Math.floor((a-3600*b)/60);return[b,c,a-3600*b-60*c].map(function(a){return 1===(a+"").length?"0"+a:a+""}).join(":")},c.prototype._registerHandlers=function(a,b,d){function e(b){var f=Math.floor(a.currentTime/b)+b;h[f]=h[f]||[],h[f].push(function(){var g,i=[f],j=a.currentTime,k=j-f,l=Math.floor(k/b);for(g=1;g<l+1;g++)i.push(f+g*b);i.forEach(function(b){setTimeout(function(){d.call(a,{seconds:b,label:c._translateSeconds(b),player:a})},0)}),f+b*i<=a.duration&&setTimeout(function(){h[f+b]=[e.bind(f+b)]},0)})}var f=this,g=a.__html5PlayerId__,h=f._handlers[g]=f._handlers[g]||{},i=[];b.events.forEach(function(b){h[b]=h[b]||[],h[b].push(function(){d.call(a,{seconds:Math.floor(a.currentTime),label:b,player:a})})}),a.duration===1/0||isNaN(a.duration)||(i=b.percentages.every.reduce(function(a,b){var c,d=100/b;for(c=1;c<=d;c++)a.push(b*c);return a},[]).concat(b.percentages.each).reduce(function(b,c){var d=Math.floor(a.duration*c/100);return 0===d||b.uniq[d]||c>100?b:(b.uniq[d]=!0,b.times.push({seconds:Math.min(a.duration,d),label:c+"%",player:a}),b)},{uniq:{},times:[]}).times);var j=b.seconds.each.map(function(b){return{seconds:b,label:c._translateSeconds(b),player:a}});i.concat(j).forEach(function(b){h[b.seconds]=h[b.seconds]||[],h[b.seconds].push(d.bind(a,b))}),b.seconds.every.forEach(e)},b.Html5MediaTracker=c}(document,window);
/*
 * v1.0.0
 * Created by the Google Analytics consultants at http://www.lunametrics.com/
 * Written by @notdanwilkerson
 * Documentation: https://github.com/lunametrics/html5-media-listener/
 * Licensed under the MIT License
 */